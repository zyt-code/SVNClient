<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Svns.ViewModels"
        xmlns:converters="using:Svns.Converters"
        xmlns:material="using:Material.Icons.Avalonia"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
        x:Class="Svns.Views.StartPageWindow"
        x:DataType="vm:StartPageViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Welcome to Svns"
        Width="900" Height="600"
        MinWidth="800" MinHeight="500"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource AppBackgroundBrush}">

    <Design.DataContext>
        <vm:StartPageViewModel/>
    </Design.DataContext>

    <Window.Resources>
        <converters:InverseBoolConverter x:Key="InverseBoolConverter"/>
    </Window.Resources>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <Border Grid.Row="0"
                Background="{DynamicResource AppSecondaryBackgroundBrush}"
                BorderBrush="{DynamicResource SidebarBorderBrush}"
                BorderThickness="0,0,0,1"
                Padding="32,24">
            <Grid ColumnDefinitions="Auto,*">
                <!-- Logo & Title -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="16">
                    <Border Width="48" Height="48"
                            Background="{DynamicResource AccentBrush}"
                            CornerRadius="12">
                        <material:MaterialIcon Kind="SourceRepository" Width="28" Height="28"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel Spacing="4" VerticalAlignment="Center">
                        <TextBlock Text="Svns" FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryTextBrush}"/>
                        <TextBlock Text="SVN Client for .NET" FontSize="13"
                                   Foreground="{DynamicResource SecondaryTextBrush}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Actions -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                    <Button Click="OnSettingsClick"
                            Background="Transparent"
                            BorderThickness="0"
                            Padding="12"
                            ToolTip.Tip="Settings">
                        <material:MaterialIcon Kind="Cog" Width="20" Height="20"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" ColumnDefinitions="*,*">
            <!-- Left Panel - Quick Actions -->
            <Border Grid.Column="0"
                    Background="Transparent"
                    Padding="48,24">
                <StackPanel Spacing="24" VerticalAlignment="Center">
                    <TextBlock Text="Quick Actions" FontSize="14" FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextBrush}"/>

                    <!-- Open Working Copy -->
                    <Button Click="OnOpenWorkingCopyClick"
                            HorizontalAlignment="Stretch"
                            Height="64"
                            Classes="primary">
                        <Grid ColumnDefinitions="Auto,*">
                            <material:MaterialIcon Grid.Column="0" Kind="FolderOpen" Width="28" Height="28" VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                                <TextBlock Text="Open Working Copy..." FontSize="15" FontWeight="Medium"/>
                                <TextBlock Text="Open an existing SVN working copy" FontSize="12"
                                           Foreground="{DynamicResource SecondaryTextBrush}"
                                           Opacity="0.8"/>
                            </StackPanel>
                        </Grid>
                    </Button>

                    <!-- Checkout -->
                    <Button Click="OnCheckoutClick"
                            HorizontalAlignment="Stretch"
                            Height="64"
                            Background="{DynamicResource AppSecondaryBackgroundBrush}"
                            BorderBrush="{DynamicResource AccentBrush}"
                            BorderThickness="1">
                        <Grid ColumnDefinitions="Auto,*">
                            <material:MaterialIcon Grid.Column="0" Kind="CloudDownload" Width="28" Height="28" VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" Margin="20,0,0,0" VerticalAlignment="Center">
                                <TextBlock Text="Checkout from Repository..." FontSize="15" FontWeight="Medium"/>
                                <TextBlock Text="Checkout a new working copy" FontSize="12"
                                           Foreground="{DynamicResource SecondaryTextBrush}"/>
                            </StackPanel>
                        </Grid>
                    </Button>
                </StackPanel>
            </Border>

            <!-- Right Panel - Recent Projects -->
            <Border Grid.Column="1"
                    Background="{DynamicResource AppSecondaryBackgroundBrush}"
                    BorderBrush="{DynamicResource SidebarBorderBrush}"
                    BorderThickness="1,0,0,0"
                    Padding="48,24">
                <Grid RowDefinitions="Auto,*">
                    <Grid Grid.Row="0" ColumnDefinitions="*,Auto" Margin="0,0,0,24">
                        <TextBlock Grid.Column="0" Text="Recent Projects" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryTextBrush}"
                                   VerticalAlignment="Center"/>
                        <Button Grid.Column="1"
                                Command="{Binding ClearRecentProjectsCommand}"
                                IsVisible="{Binding HasNoRecentProjects, Converter={StaticResource InverseBoolConverter}}"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="8"
                                ToolTip.Tip="Clear all">
                            <material:MaterialIcon Kind="DeleteOutline" Width="18" Height="18"
                                                   Foreground="{DynamicResource SecondaryTextBrush}"/>
                        </Button>
                    </Grid>

                    <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding RecentProjects}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:RecentProjectItem">
                                    <Border Background="{DynamicResource CardBackgroundBrush}"
                                            BorderBrush="{DynamicResource CardBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Margin="0,0,0,12">
                                        <Button Command="{Binding $parent[ItemsControl].((vm:StartPageViewModel)DataContext).OpenRecentProjectCommand}"
                                                CommandParameter="{Binding}"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Padding="20,16"
                                                HorizontalAlignment="Stretch"
                                                HorizontalContentAlignment="Stretch">
                                            <Grid ColumnDefinitions="*,Auto">
                                                <StackPanel Grid.Column="0" Spacing="4">
                                                    <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Medium"
                                                               Foreground="{DynamicResource PrimaryTextBrush}"/>
                                                    <TextBlock Text="{Binding Path}" FontSize="12"
                                                               Foreground="{DynamicResource SecondaryTextBrush}"
                                                               TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Text="{Binding DisplayDate}" FontSize="11"
                                                               Foreground="{DynamicResource SecondaryTextBrush}"
                                                               Opacity="0.7"
                                                               Margin="0,4,0,0"/>
                                                </StackPanel>
                                                <Button Grid.Column="1"
                                                        Command="{Binding $parent[ItemsControl].((vm:StartPageViewModel)DataContext).RemoveRecentProjectCommand}"
                                                        CommandParameter="{Binding}"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        Padding="8"
                                                        VerticalAlignment="Top"
                                                        ToolTip.Tip="Remove from list">
                                                    <material:MaterialIcon Kind="Close" Width="16" Height="16"
                                                                           Foreground="{DynamicResource SecondaryTextBrush}"/>
                                                </Button>
                                            </Grid>
                                        </Button>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <!-- Empty State -->
                    <StackPanel Grid.Row="1" IsVisible="{Binding HasNoRecentProjects}"
                                Spacing="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <material:MaterialIcon Kind="FolderOutline" Width="64" Height="64" Opacity="0.3"/>
                        <TextBlock Text="No recent projects" FontSize="15"
                                   Foreground="{DynamicResource SecondaryTextBrush}"/>
                        <TextBlock Text="Open a working copy to get started" FontSize="12"
                                   Foreground="{DynamicResource SecondaryTextBrush}"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer -->
        <Border Grid.Row="2"
                Background="{DynamicResource AppSecondaryBackgroundBrush}"
                BorderBrush="{DynamicResource SidebarBorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="24,16">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Grid.Column="0" FontSize="12"
                           Foreground="{DynamicResource SecondaryTextBrush}">
                    <Run Text="Svns "/>
                    <Run Text="v1.0.0"/>
                </TextBlock>
                <TextBlock Grid.Column="1" FontSize="12"
                           Foreground="{DynamicResource SecondaryTextBrush}">
                    <Run Text="Built with "/>
                    <Run Text="Avalonia UI"/>
                </TextBlock>
            </Grid>
        </Border>
    </Grid>

</Window>
