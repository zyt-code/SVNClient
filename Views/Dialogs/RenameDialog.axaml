<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Svns.ViewModels"
        xmlns:mi="using:Material.Icons.Avalonia"
        mc:Ignorable="d" d:DesignWidth="450" d:DesignHeight="350"
        x:Class="Svns.Views.Dialogs.RenameDialog"
        x:DataType="vm:RenameViewModel"
        Title="Rename - Svns"
        Icon="/Assets/avalonia-logo.ico"
        Classes="dialog small"
        Width="450" Height="350"
        MinWidth="400" MinHeight="300"
        Background="{DynamicResource AppBackgroundBrush}"
        WindowStartupLocation="CenterOwner"
        CanResize="False">

    <Design.DataContext>
        <vm:RenameViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header -->
        <Border Grid.Row="0" Classes="dialog-header">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <mi:MaterialIcon Kind="RenameBox" Width="32" Height="32"
                                 Foreground="{DynamicResource AccentBrush}"
                                 VerticalAlignment="Center"/>
                <StackPanel Spacing="2" VerticalAlignment="Center">
                    <TextBlock Text="Rename" FontSize="20" FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <TextBlock Text="Rename a file or directory in the working copy"
                               FontSize="13"
                               Foreground="{DynamicResource SecondaryTextBrush}"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" Padding="24,16">
            <StackPanel Spacing="16">
                <!-- Original Name -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Original Name" FontSize="13" FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <Border Classes="dialog-input">
                        <TextBlock Text="{Binding OriginalName}"
                                   FontSize="13"
                                   Foreground="{DynamicResource SecondaryTextBrush}"
                                   TextTrimming="CharacterEllipsis"/>
                    </Border>
                </StackPanel>

                <!-- New Name -->
                <StackPanel Spacing="8">
                    <TextBlock Text="New Name" FontSize="13" FontWeight="SemiBold"
                               Foreground="{DynamicResource PrimaryTextBrush}"/>
                    <Border Classes="dialog-input">
                        <TextBox Text="{Binding NewName, Mode=TwoWay}"
                                 Watermark="Enter new name..."
                                 IsEnabled="{Binding !IsRenaming}"/>
                    </Border>
                </StackPanel>

                <!-- Error Message -->
                <Border Background="#FFF3E0"
                        BorderBrush="#FF9800"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        IsVisible="{Binding HasError}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <mi:MaterialIcon Kind="AlertCircle" Width="20" Height="20"
                                         Foreground="#F44336"
                                         VerticalAlignment="Top"/>
                        <TextBlock Text="{Binding ErrorMessage}"
                                   FontSize="12"
                                   Foreground="#D32F2F"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>

                <!-- Status Message -->
                <TextBlock Text="{Binding StatusMessage}"
                           FontSize="12"
                           Foreground="{DynamicResource SecondaryTextBrush}"
                           IsVisible="{Binding StatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="2" Classes="dialog-footer">
            <Grid ColumnDefinitions="*,Auto,Auto">
                <TextBlock Grid.Column="0"
                           Text="Rename operation"
                           FontSize="12"
                           Foreground="{DynamicResource SecondaryTextBrush}"
                           VerticalAlignment="Center"/>

                <Button Grid.Column="1"
                        Content="Cancel"
                        Command="{Binding CancelCommand}"
                        IsEnabled="{Binding !IsRenaming}"
                        Padding="24,10"
                        Margin="0,0,12,0"/>

                <Button Grid.Column="2"
                        Content="Rename"
                        Command="{Binding RenameCommand}"
                        IsEnabled="{Binding CanRename}"
                        Padding="24,10"
                        Classes="primary"/>
            </Grid>
        </Border>
    </Grid>

</Window>
